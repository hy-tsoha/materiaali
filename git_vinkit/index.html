<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <title>
      
      Git-vinkkejä - Tietokannat ja web-ohjelmointi
      
    </title>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          CommonHTML: {
            scale: 87
          }
        });
        </script>
    <script type="text/javascript" async
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    <link rel='stylesheet' type='text/css' media='screen' href=/materiaali/assets/css/main.css>
    <link rel='stylesheet' type='text/css' media='screen' href=/materiaali/assets/css/syntax.css>

    <script src=/materiaali/assets/js/main.js></script>

</head>


<body id="chapter">
    
<nav class="no-nav" id="side-nav" >
    <button id="hide" onclick="hideSideNav()"> &#x2715;</button>
    <button id="show" onclick="showSideNav()"> </button>
    <h2>Tietokannat ja web-ohjelmointi</h2>
    <ol>
       
        <li class="side-nav-obj" id="indexnav"><a href=/materiaali/>Etusivu </a></li>

        
        
        
        
        <li class="side-nav-obj" id="Aikataulu ja ohjeetnav"><a href="/materiaali/aikataulu/">Aikataulu ja ohjeet</a></li>
        
        
        
        <li class="side-nav-obj" id="Arvostelunav"><a href="/materiaali/arvostelu/">Arvostelu</a></li>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <li class="side-nav-obj" id="Kysymyksiä ja vastauksianav"><a href="/materiaali/kysymykset/">Kysymyksiä ja vastauksia</a></li>
        
        
        
        
        
        
        
        
        
        
        
        
        
        <li class="side-nav-obj" id="Taustamateriaalinav"><a href="/materiaali/taustamateriaali/">Taustamateriaali</a></li>
        
        
        
        
        
        
        
        
        <br>
        
        
        <li class="side-nav-obj" id="Osa 1nav"><a href="/materiaali/osa-1/">Osa 1</a></li>
        
        
        
            
            <li class="side-nav-sub-obj" id="Johdatus web-sovelluksiinnav"><a href="/materiaali/osa-1/#johdatus-web-sovelluksiin">Johdatus web-sovelluksiin</a></li>
        
            
            <li class="side-nav-sub-obj" id="Sivupyynnötnav"><a href="/materiaali/osa-1/#sivupyynnöt">Sivupyynnöt</a></li>
        
            
            <li class="side-nav-sub-obj" id="Lomakkeiden käsittelynav"><a href="/materiaali/osa-1/#lomakkeiden-käsittely">Lomakkeiden käsittely</a></li>
        
            
            <li class="side-nav-sub-obj" id="Sovelluksen toimintanav"><a href="/materiaali/osa-1/#sovelluksen-toiminta">Sovelluksen toiminta</a></li>
        
            
        
        
        
        
        <li class="side-nav-obj" id="Osa 2nav"><a href="/materiaali/osa-2/">Osa 2</a></li>
        
        
        
            
            <li class="side-nav-sub-obj" id="Tietokannan käyttäminennav"><a href="/materiaali/osa-2/#tietokannan-käyttäminen">Tietokannan käyttäminen</a></li>
        
            
            <li class="side-nav-sub-obj" id="Esimerkki: Kyselytnav"><a href="/materiaali/osa-2/#esimerkki-kyselyt">Esimerkki: Kyselyt</a></li>
        
            
            <li class="side-nav-sub-obj" id="Istunnot ja kirjautuminennav"><a href="/materiaali/osa-2/#istunnot-ja-kirjautuminen">Istunnot ja kirjautuminen</a></li>
        
            
            <li class="side-nav-sub-obj" id="Hakutoimintonav"><a href="/materiaali/osa-2/#hakutoiminto">Hakutoiminto</a></li>
        
            
            <li class="side-nav-sub-obj" id="Tiedon poistaminennav"><a href="/materiaali/osa-2/#tiedon-poistaminen">Tiedon poistaminen</a></li>
        
            
        
        
        
        
        <li class="side-nav-obj" id="Osa 3nav"><a href="/materiaali/osa-3/">Osa 3</a></li>
        
        
        
            
            <li class="side-nav-sub-obj" id="Versionhallintanav"><a href="/materiaali/osa-3/#versionhallinta">Versionhallinta</a></li>
        
            
            <li class="side-nav-sub-obj" id="Sovellus tuotantoonnav"><a href="/materiaali/osa-3/#sovellus-tuotantoon">Sovellus tuotantoon</a></li>
        
            
            <li class="side-nav-sub-obj" id="Virheiden etsiminennav"><a href="/materiaali/osa-3/#virheiden-etsiminen">Virheiden etsiminen</a></li>
        
            
            <li class="side-nav-sub-obj" id="Sovelluksen rakennenav"><a href="/materiaali/osa-3/#sovelluksen-rakenne">Sovelluksen rakenne</a></li>
        
            
            <li class="side-nav-sub-obj" id="Esimerkki: Keskustelunav"><a href="/materiaali/osa-3/#esimerkki-keskustelu">Esimerkki: Keskustelu</a></li>
        
            
        
        
        
        
        <li class="side-nav-obj" id="Osa 4nav"><a href="/materiaali/osa-4/">Osa 4</a></li>
        
        
        
            
            <li class="side-nav-sub-obj" id="Oikeudet ja syötteetnav"><a href="/materiaali/osa-4/#oikeudet-ja-syötteet">Oikeudet ja syötteet</a></li>
        
            
            <li class="side-nav-sub-obj" id="Tietoturvanav"><a href="/materiaali/osa-4/#tietoturva">Tietoturva</a></li>
        
            
            <li class="side-nav-sub-obj" id="Käytettävyysnav"><a href="/materiaali/osa-4/#käytettävyys">Käytettävyys</a></li>
        
            
            <li class="side-nav-sub-obj" id="Ulkoasun toteutusnav"><a href="/materiaali/osa-4/#ulkoasun-toteutus">Ulkoasun toteutus</a></li>
        
            
        
        
        
    </ol>
</nav>

    <div class="page-content">
        <div class="content">
    <!--<div class="table-of-content" id="tof" style="display: none;">
    <ul>
        
    </ul>
</div>-->

    <h1 id="git-vinkkejä">Git-vinkkejä</h1>

<p>Tällä sivulla on vinkkejä Gitin käyttämiseen tämän kurssin projektissa. Oletuksena on, että projekti on GitHubissa ja se on kloonattu omalle koneelle.</p>

<h2 id="lähtökohta">Lähtökohta</h2>

<p>Kun projektia kehitetään, omalla koneella on paikallinen projektin <em>työhakemisto</em> sekä siihen liittyvä repositorio. Kun työhakemiston muutokset halutaan talteen repositorioon, tiedostot valitaan ensin komennolla <code class="language-html highlighter-rouge">git add</code> ja sitten suoritetaan komento <code class="language-html highlighter-rouge">git commit</code>.</p>

<p>Tämän lisäksi GitHubissa on toinen repositorio, jonka sisällön on tarkoitus olla sama kuin oman koneen repositoriossa. Komento <code class="language-html highlighter-rouge">git push</code> siirtää muutoksia omalta koneelta GitHubiin, ja komento <code class="language-html highlighter-rouge">git pull</code> puolestaan siirtää muutoksia GitHubista omalle koneelle.</p>

<h2 id="commitin-tekeminen">Commitin tekeminen</h2>

<p>Commitin tekeminen tarkoittaa, että haluamme tallentaa työhakemistoon tehtyjä muutoksia repositorioon. Tässä on muutamia vaiheita, joiden merkitys kannattaa ymmärtää.</p>

<p>Komento <code class="language-html highlighter-rouge">git status</code> kertoo repositorion tilanteen, ja sitä kannattaa käyttää usein. Komento kertoo, mitä muutoksia työhakemistoon on tehty. Komennon suoritus voi näyttää vaikkapa seuraavalta:</p>

<div class="language-prompt highlighter-rouge"><div class="highlight"><pre class="syntax"><code><span class="p">$ </span>git status
On branch main
Changes not staged for commit:
  (use "git add &lt;file&gt;..." to update what will be committed)
  (use "git checkout -- &lt;file&gt;..." to discard changes in working directory)

	modified:   apina.txt
	modified:   banaani.txt

Untracked files:
  (use "git add &lt;file&gt;..." to include in what will be committed)

	cembalo.txt

no changes added to commit (use "git add" and/or "git commit -a")
</code></pre></div></div>

<p>Tämä tarkoittaa, että tiedostot <code class="language-html highlighter-rouge">apina.txt</code> ja <code class="language-html highlighter-rouge">banaani.txt</code> ovat repositoriossa, mutta niitä on muutettu työhakemistossa. Lisäksi työhakemistoon on luotu uusi tiedosto <code class="language-html highlighter-rouge">cembalo.txt</code>, jota ei vielä ole lainkaan repositoriossa.</p>

<p>Kun haluamme viedä muutokset repositorioon, teemme uuden commitin. Voimme valita komennolla <code class="language-html highlighter-rouge">git add</code> tiedostot, jotka tulevat mukaan commitiin. Esimerkiksi voimme valita tiedostot <code class="language-html highlighter-rouge">apina.txt</code> ja <code class="language-html highlighter-rouge">cembalo.txt</code> näin:</p>

<div class="language-prompt highlighter-rouge"><div class="highlight"><pre class="syntax"><code><span class="p">$ </span>git add apina.txt
<span class="p">$ </span>git add cembalo.txt
</code></pre></div></div>

<p>Tämän jälkeen <code class="language-html highlighter-rouge">git status</code> näyttää muuttuneen tilanteen:</p>

<div class="language-prompt highlighter-rouge"><div class="highlight"><pre class="syntax"><code><span class="p">$ </span>git status
On branch main
Changes to be committed:
  (use "git reset HEAD &lt;file&gt;..." to unstage)

	modified:   apina.txt
	new file:   cembalo.txt

Changes not staged for commit:
  (use "git add &lt;file&gt;..." to update what will be committed)
  (use "git checkout -- &lt;file&gt;..." to discard changes in working directory)

	modified:   banaani.txt
</code></pre></div></div>

<p>Tässä tiedostot <code class="language-html highlighter-rouge">apinat.txt</code> ja <code class="language-html highlighter-rouge">cembalo.txt</code> on valittu commitiin. Näemme edelleen, että tiedostoa <code class="language-html highlighter-rouge">banaani.txt</code> on muokattu, mutta se ei ole menossa commitiin.</p>

<p>Seuraava vaihe on suorittaa komento <code class="language-html highlighter-rouge">git commit</code>, joka suorittaa commitin. Tässä yhteydessä annetaan viesti, joka kertoo, mitä muutoksia kyseinen commit tekee repositorioon.</p>

<div class="language-prompt highlighter-rouge"><div class="highlight"><pre class="syntax"><code><span class="p">$ </span>git commit -m "Update apina and create cembalo"
[main 7cfdfab] Update apina and create cembalo
 2 files changed, 1 insertion(+)
 create mode 100644 cembalo.txt
</code></pre></div></div>

<p>Tämän jälkeen repositorion tilanne näyttää tältä:</p>

<div class="language-prompt highlighter-rouge"><div class="highlight"><pre class="syntax"><code><span class="p">$ </span>git status
On branch main
Changes not staged for commit:
  (use "git add &lt;file&gt;..." to update what will be committed)
  (use "git checkout -- &lt;file&gt;..." to discard changes in working directory)

	modified:   banaani.txt

no changes added to commit (use "git add" and/or "git commit -a")
</code></pre></div></div>

<p>Muutettu tiedosto <code class="language-html highlighter-rouge">banaani.txt</code> näkyy edelleen tässä, mutta listalla ei ole enää muita tiedostoja, koska niiden uusin versio on nyt repositoriossa.</p>

<p>Tässä vaiheessa muutokset on jo tehty repositorioon, mutta vasta paikallisesti. Prosessin viimeistelee komento <code class="language-html highlighter-rouge">git push</code>, joka siirtää muutokset GitHubiin:</p>

<div class="language-prompt highlighter-rouge"><div class="highlight"><pre class="syntax"><code><span class="p">$ </span>git push
</code></pre></div></div>

<h2 id="miten-tehdä-hyvä-commit">Miten tehdä hyvä commit?</h2>

<p>Commitin tekijän on päätettävä kaksi asiaa: mitä tiedostoja commitiin tulee mukaan ja mikä on commitin viesti. Huonoin ratkaisu on laittaa mukaan sokkona kaikki muutetut tiedostot ja viestiksi “Some changes” tai vastaavaa.</p>

<p>Commitissa tulisi olla muutoksia, jotka todella halutaan kaikkien näkyville repositorioon ja jotka liittyvät tiettyyn yksittäiseen asiaan (kuten uuden ominaisuuden toteutus tai jonkin bugin korjaus). Tämän vuoksi on hyvä katsoa komennolla <code class="language-html highlighter-rouge">git status</code>, mitä on tapahtunut, ja valita commitiin oikeat tiedostot. Jos muokkaat samaa tiedostoa, muista tehdä tallennus ja commit, ennen kuin siirryt työskentelemään seuraavan asian parissa.</p>

<p>Commit-viestien kirjoittaminen on oma taiteenlajinsa. Viestin tulisi kertoa selkeästi, mitä muutoksia kyseinen commit aiheuttaa ja miksi se tehdään. Esimerkiksi <a href="https://chris.beams.io/posts/git-commit/">Chris Beamsin ohje</a> on hyvää luettavaa ihanteista, joihin voi pyrkiä.</p>

<p>Kun commitit on tehty hyvin, projektia on mukava katsella myöhemmin GitHubissa. Viesteistä voi seurata, miten projekti on kehittynyt ja mitä muutoksia on tehty milloinkin.</p>

<h2 id="muutosten-peruminen">Muutosten peruminen</h2>

<h3 id="paikallisen-muutoksen-peruminen">Paikallisen muutoksen peruminen</h3>

<p>Tarkastellaan vielä tilannetta, jossa tiedostoa <code class="language-html highlighter-rouge">banaani.txt</code> on muutettu:</p>

<div class="language-prompt highlighter-rouge"><div class="highlight"><pre class="syntax"><code><span class="p">$ </span>git status
On branch main
Changes not staged for commit:
  (use "git add &lt;file&gt;..." to update what will be committed)
  (use "git checkout -- &lt;file&gt;..." to discard changes in working directory)

	modified:   banaani.txt

no changes added to commit (use "git add" and/or "git commit -a")
</code></pre></div></div>

<p>Saattaa olla, että muutos oli erehdys ja haluaisimme perua sen. Voimme noudattaa yllä olevaa neuvoa ja perua muutoksen näin:</p>

<div class="language-prompt highlighter-rouge"><div class="highlight"><pre class="syntax"><code><span class="p">$ </span>git checkout banaani.txt
</code></pre></div></div>

<p>Tämä komento hakee tiedoston <code class="language-html highlighter-rouge">banaani.txt</code> repositoriosta ja korvaa sillä muutetun tiedoston. Nyt työhakemiston tiedoston sisältö on taas sama kuin repositoriossa:</p>

<div class="language-prompt highlighter-rouge"><div class="highlight"><pre class="syntax"><code><span class="p">$ </span>git status
On branch main
nothing to commit, working tree clean
</code></pre></div></div>

<h3 id="tiedosto-pois-commitista">Tiedosto pois commitista</h3>

<p>Entä jos laitamme muokatun tiedoston vahingossa mukaan commitiin, mutta emme haluakaan tehdä commitia? Silloin tilanne näyttää seuraavalta:</p>

<div class="language-prompt highlighter-rouge"><div class="highlight"><pre class="syntax"><code><span class="p">$ </span>git add banaani.txt
<span class="p">$ </span>git status
On branch main
Changes to be committed:
  (use "git reset HEAD &lt;file&gt;..." to unstage)

	modified:   banaani.txt
</code></pre></div></div>

<p>Tässäkin tapauksessa voimme seurata komennon antamaa neuvoa:</p>

<div class="language-prompt highlighter-rouge"><div class="highlight"><pre class="syntax"><code><span class="p">$ </span>git reset HEAD banaani.txt
</code></pre></div></div>

<p>Tämän seurauksena tiedosto <code class="language-html highlighter-rouge">banaani.txt</code> poistetaan commitista ja se näkyy taas muokattuna:</p>

<div class="language-prompt highlighter-rouge"><div class="highlight"><pre class="syntax"><code><span class="p">$ </span>git status
On branch main
Changes not staged for commit:
  (use "git add &lt;file&gt;..." to update what will be committed)
  (use "git checkout -- &lt;file&gt;..." to discard changes in working directory)

        modified:   banaani.txt

no changes added to commit (use "git add" and/or "git commit -a")
</code></pre></div></div>

<p>Vastaavasti komento <code class="language-html highlighter-rouge">git reset HEAD</code> ilman tiedostoa poistaa kaikki commitiin lisätyt tiedostot ja voimme aloittaa puhtaalta pöydältä commitin valmistelut.</p>

<h3 id="commitin-peruminen">Commitin peruminen</h3>

<p>Seuraavassa tilanteessa olemme vieneet commitin loppuun ja tajuamme vasta sitten, että commit oli virhe:</p>

<div class="language-prompt highlighter-rouge"><div class="highlight"><pre class="syntax"><code><span class="p">$ </span>git add banaani.txt
<span class="p">$ </span>git commit -m "Change banaani"
[main eff67d3] Change banaani
 1 file changed, 1 insertion(+)
</code></pre></div></div>

<p>Tässä vaiheessa commit näkyy jo tehtyjen commitien listalla:</p>

<div class="language-prompt highlighter-rouge"><div class="highlight"><pre class="syntax"><code><span class="p">$ </span>git log
commit eff67d3743e37837e99b278c3843b30280e86925 (HEAD -&gt; main)
Author: Antti Laaksonen &lt;ahslaaks@cs.helsinki.fi&gt;
Date:   Tue Jul 14 19:18:55 2020 +0300

    Change banaani

commit 7cfdfabca6b021bbe314d77b1ff0718cc415b9d5
Author: Antti Laaksonen &lt;ahslaaks@cs.helsinki.fi&gt;
Date:   Tue Jul 14 17:36:10 2020 +0300

    Update apina and create cembalo

...
</code></pre></div></div>

<p>Kuitenkin kun commit on tehty vasta paikallisesti, pystymme perumaan sen näin:</p>

<div class="language-prompt highlighter-rouge"><div class="highlight"><pre class="syntax"><code><span class="p">$ </span>git reset HEAD~1
</code></pre></div></div>

<p>Tämä komento siirtää repositorion tilan yhtä askelta aiemmaksi ja kaikki on taas hyvin:</p>

<div class="language-prompt highlighter-rouge"><div class="highlight"><pre class="syntax"><code><span class="p">$ </span>git log
commit 7cfdfabca6b021bbe314d77b1ff0718cc415b9d5 (HEAD -&gt; main)
Author: Antti Laaksonen &lt;ahslaaks@cs.helsinki.fi&gt;
Date:   Tue Jul 14 17:36:10 2020 +0300

    Update apina and create cembalo

...
</code></pre></div></div>

<p>Kuitenkin jos muutos on viety jo eteenpäin (<code class="language-html highlighter-rouge">git push</code>), niin sama konsti ei toimi, koska joku toinen on saattanut käydä hakemassa tehdyn muutoksen ja peruminen siinä vaiheessa sekoittaisi pahasti asioita. Tällöin ratkaisu on tehdä uusi commit, joka peruuttaa edellisen commitin.</p>

</div>
        <div class="footer">
<img src=/materiaali/assets/img/site/HY_logo.png>
</div>
    </div>
</body>

</html>